## –°–±–æ—Ä–Ω–∏–∫ Python Telegram –±–æ—Ç–æ–≤ –æ—Ç [@rs1ow](https://t.me/rs1ow)

### –ó–∞ –æ—Å–Ω–æ–≤—É –≤–∑—è—Ç—ã:

1. [python 3.11](https://www.python.org/downloads/release/python-3110/)
2. [aiogram](https://aiogram.dev/), –≤–µ—Ä—Å–∏—è: 3.1 - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è Telegram
3. [SQLAlchemy](https://www.sqlalchemy.org/), –≤–µ—Ä—Å–∏—è: 2.0 - ORM –¥–ª—è Postgres –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
4. [redis](https://redis.io/docs/connect/clients/python/), –≤–µ—Ä—Å–∏—è: latest - –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è RedisStorage –≤ aiogram
5. [aiohttp](https://docs.aiohttp.org/en/stable/), –≤–µ—Ä—Å–∏—è: 4.0 - –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –¥–ª—è webhook, –∞ —Ç–∞–∫–∂–µ –¥–ª—è HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤
6. [selenium](https://hub.docker.com/r/selenium/standalone-chrome), –≤–µ—Ä—Å–∏—è: standalone-chrome, –∫–∞–∫ docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -
   –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å–∞–π—Ç–æ–≤
7. [nginx](https://hub.docker.com/_/nginx), –≤–µ—Ä—Å–∏—è: latest - –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –¥–ª—è aiohttp, + SSL

---

### –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±–æ—Ç–∞:

#### 1. (–Ω–µ)—Ä–∞–±–æ—á–∞—è –ø–ª–æ—â–∞–¥–∫–∞ üò∂‚Äçüå´Ô∏è

- –∞—Ä—Ö–∏–≤–∞—Ü–∏—è —Ñ–æ—Ç–æ (telegram-—Ñ–æ—Ç–æ –∏ —Ñ–∞–π–ª–æ–≤) –≤ zip-–∞—Ä—Ö–∏–≤
- —Å–∫–ª–æ–Ω–µ–Ω–∏—è –§–ò–û (–Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ) –ø–æ –≤—Å–µ–º –ø–∞–¥–µ–∂–∞–º —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞
- —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ—Å–æ–æ–±—â–µ–Ω–∏—è telegram (–¥–∞, —è –∑–Ω–∞—é, —á—Ç–æ —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –µ—Å—Ç—å –≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, –Ω–æ –º–Ω–µ –ø–ª–µ–≤–∞—Ç—å üòÇ)
- –ø—Ä–æ–≤–µ—Ä–∫–∞ –ò–ù–ù –ø–æ –¥–∞–Ω–Ω—ã–º –ø–∞—Å–ø–æ—Ä—Ç–∞ (—Å –ø–æ–º–æ—â—å—é selenium –∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ https://service.nalog.ru/inn.do)
- –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–Ω–µ–π —Ä–æ–∂–¥–µ–Ω–∏–π (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
- –∞–≤—Ç–æ–æ—Ç–ø—Ä–∞–≤–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥–Ω—è—Ö —Ä–æ–∂–¥–µ–Ω–∏—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 10 —á–∞—Å–æ–≤ —É—Ç—Ä–∞

#### 2. (–±–µ—Å)–ø–ª–∞—Ç–Ω–∞—è —à–∞—É—Ä–º–∞ üåØ - –∏–º–∏—Ç–∞—Ü–∏—è —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ –æ –ø–µ—Ä–µ–≤–æ–¥–∞—Ö –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –±–∞–Ω–∫–∏.

###### –ò–°–ö–õ–Æ–ß–ò–¢–ï–õ–¨–ù–û –î–õ–Ø –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø!

#### 3. –º—É–∑—ã–∫–∞ üéß

- —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –º—É–∑—ã–∫–∏ —Å YouTube, –≤ —Ç–æ–º —á–∏—Å–ª–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —á–∞—Å—Ç–∏ –≤–∏–¥–µ–æ (–Ω–∞ –æ—Å–Ω–æ–≤–µ [yt-dlp](https://github.com/yt-dlp/yt-dlp))
- —Ä–µ–¥–∞–∫—Ç–æ—Ä —Ç–µ–≥–æ–≤ MP3 (–Ω–∞ –æ—Å–Ω–æ–≤–µ [eyeD3](https://eyed3.readthedocs.io/en/latest/))

#### 4. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤

- –æ—á–∏—Å—Ç–∫–∞ –¥–Ω–µ–π —Ä–æ–∂–¥–µ–Ω–∏–π
- —Ñ–∞–π–ª—ã –ª–æ–≥–æ–≤

---

#### –î–ª—è –∑–∞–ø—É—Å–∫–∞ –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º .env —Ñ–∞–π–ª.

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ .env —Ñ–∞–π–ª–∞:

      --- AIOGRAM ENVS ---
      - **BOT_TOKEN** - —Ç–æ–∫–µ–Ω telegram –±–æ—Ç–∞
      - **TIMEZONE** - pytz timezone, –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Å –ø–æ–º–æ—â—å—é scheduler
      - **OWNER_ID** - Telegram account ID, –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∞–¥–º–∏–Ω–æ–≤ –∏ –¥–æ—Å—Ç—É–ø–∞ –∫ –æ—Ç–¥–µ–ª—å–Ω—ã–º –ø—É–Ω–∫—Ç–∞–º –º–µ–Ω—é
      - **MORPH_URL** - HTTP-endpoint –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞ –ø–æ —Å–∫–ª–æ–Ω–µ–Ω–∏—é –§–ò–û
      
      --- HTTP ENVS ---
      - **WEBHOOK_PATH** - –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å –¥–ª—è telegram webhook
      - **BASE_WEBHOOK_URL** - http-–∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞ (–¥–æ–º–µ–Ω). –ù–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è telegram webhook
      - **BASE_WEBHOOK_PORT** - –ø–æ—Ä—Ç –¥–ª—è telegram webhook. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 443, –Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏ 8443 –ø–æ—Ä—Ç–∞
      - **WEB_SERVER_PORT** - –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø–æ—Ä—Ç aiohttp
      - **WEBHOOK_SECRET** - —Å–µ–∫—Ä–µ—Ç–Ω—ã–π —Ç–æ–∫–µ–Ω –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ telegram –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ webhook-–∑–∞–ø—Ä–æ—Å–∞
      - **CERTS_DIR** - –ø—É—Ç—å –¥–ª—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ SSL. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é [certbot](https://certbot.eff.org/)

      --- DATABASE ENVS ---    
      - **POSTGRES_USER** - –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è PostgresQL
      - **POSTGRES_PASSWORD** - –ø–∞—Ä–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ PostgresQL
      - **POSTGRES_DB** - –∏–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö PostgresQL
      - **POSTGRES_PORT** - –≤–Ω–µ—à–Ω–∏–π –ø–æ—Ä—Ç PostgresQL
      - **DATABASE_URL** - URL PostgresQL –¥–ª—è SQLAlchemy

      --- OTHER ENVS ---
      - **REDIS_PASS** - –ø–∞—Ä–æ–ª—å –¥–ª—è redis-—Ö—Ä–∞–Ω–∏–ª–∏—â–∞
      - **SELENIUM_PORT** - –≤–Ω–µ—à–Ω–∏–π –ø–æ—Ä—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ selenium
      - **SELENIUM_URL** - –ø–æ–ª–Ω—ã–π URL –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ selenium, –≤ —Ñ–æ—Ä–º–∞—Ç–µ http://<selenium_address>/wd/hub

### –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ .env —Ñ–∞–π–ª–∞:

      - –∞–∞–∞

---

### –ó–∞–ø—É—Å–∫ (2 –≤–∞—Ä–∏–∞–Ω—Ç–∞):

      1. docker compose up -d
      2. chmod +x ./start.sh && ./start.sh

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ (2 –≤–∞—Ä–∏–∞–Ω—Ç–∞):

      1. docker compose down
      2. chmod +x ./stop.sh && ./stop.sh

### –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Å–∏—Å—Ç–µ–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–æ—Å—Ç–∞–Ω–æ–≤–∫–∞, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å github, –∑–∞–ø—É—Å–∫) –∫–æ–º–∞–Ω–¥–æ–π

      chmod +x ./update.sh && ./update.sh

---

### HTTP ENDPOINTS:

#### 1. **/birthdays** (–º–µ—Ç–æ–¥ - PUT) - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π.

–û–∂–∏–¥–∞–µ—Ç—Å—è —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ - **—Å–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤**

##### –æ–∂–∏–¥–∞–µ–º—ã–µ –ø–æ–ª—è –æ–±—ä–µ–∫—Ç–∞:

      - **uuid**: str [—É–Ω–∏–∫–∞–ª—å–Ω—ã–π UUID, –∫–∞–∫ –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á SQL]
      - **fio**: str [–§–ò–û –≤ —Ñ–æ—Ä–º–∞—Ç–µ –§–∞–º–∏–ª–∏—è, –ò–º—è, –û—Ç—á–µ—Å—Ç–≤–æ]
      - **rank**: str | None [–ó–≤–∞–Ω–∏–µ, –º–æ–∂–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å]
      - **post**: str [–î–æ–ª–∂–Ω–æ—Å—Ç—å]
      - **date**: date [–î–∞—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ DD.MM.YYYY]

##### –æ—Ç–≤–µ—Ç:

      - 200 - OK
      - 422 - –ø—Ä–∏ –æ—à–∏–±–∫–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

#### 2. **/birthdays** (–º–µ—Ç–æ–¥ - DELETE) - —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π (–æ—á–∏—Å—Ç–∫–∞)

##### –æ—Ç–≤–µ—Ç:

    - 200 - OK

#### 3. **/birthdays/{uuid}** (–º–µ—Ç–æ–¥ - DELETE) - —É–¥–∞–ª–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ —Å uuid –∏–¥–µ–Ω—Ç–µ—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º.

–û–∂–∏–¥–∞–µ—Ç—Å—è –∞—Ä–≥—É–º–µ–Ω—Ç path - **uuid**: str `[—É–Ω–∏–∫–∞–ª—å–Ω—ã–π UUID, –∫–∞–∫ –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á SQL]`

##### –æ—Ç–≤–µ—Ç:

      - 200 - OK
      - 404 - –∑–∞–ø–∏—Å—å –∫ –¥–∞–Ω–Ω—ã–º uuid –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
      - 422 - –ø—Ä–∏ –æ—à–∏–±–∫–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

---

